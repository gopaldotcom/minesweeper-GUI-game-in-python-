import sys
from PyQt5.QtWidgets import QApplication, QMainWindow, QPushButton, QGridLayout, QWidget, QMessageBox
import random
from PyQt5.QtCore import Qt

class MineButton(QPushButton):
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        self.is_flagged = False

    def mousePressEvent(self, event):
        if event.button() == Qt.RightButton:
            self.toggle_flag()
        else:
            super().mousePressEvent(event)

    def toggle_flag(self):
        if not self.isEnabled():
            return
        self.is_flagged = not self.is_flagged
        self.setText('F' if self.is_flagged else '')
        self.setStyleSheet('background-color: orange' if self.is_flagged else '')

class Minesweeper(QMainWindow):
    def __init__(self, rows=10, cols=10, mines=10):
        super().__init__()

        self.rows = rows
        self.cols = cols
        self.mines = mines
        self.grid = []
        self.revealed = []

        self.initUI()

    def initUI(self):
        self.central_widget = QWidget()
        self.setCentralWidget(self.central_widget)
        self.grid_layout = QGridLayout()
        self.central_widget.setLayout(self.grid_layout)

        self.create_grid()
        self.place_mines()

        self.setWindowTitle('minesweeper')
        self.show()

    def create_grid(self):
        for row in range(self.rows):
            row_cells = []
            for col in range(self.cols):
                button = MineButton('')
                button.setFixedSize(30, 30)
                button.clicked.connect(self.cell_clicked)
                self.grid_layout.addWidget(button, row, col)
                row_cells.append(button)
            self.grid.append(row_cells)

    def place_mines(self):
        for _ in range(self.mines):
            while True:
                row = random.randint(0, self.rows - 1)
                col = random.randint(0, self.cols - 1)
                if not hasattr(self.grid[row][col], 'mine'):
                    self.grid[row][col].mine = True
                    break
